<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://openvoiceos.github.io/community-docs/images_buildroot/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Buildroot - OVOS User Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Buildroot";
        var mkdocs_page_input_path = "images_buildroot.md";
        var mkdocs_page_url = "/community-docs/images_buildroot/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> OVOS User Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Home</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="..">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../about/">About</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Supported Hardware</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../hardware/">Introduction</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../hardware_audio/">Audio</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../hardware_video/">Video</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../architecture/">OpenVoiceOS Architecture</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Quick Start Guide</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../qs_intro/">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../qs_first_boot/">First Boot</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../qs_next_steps/">Next Steps</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Installation Options</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../install_intro/">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../qs_intro/">Installing an Image</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../install_ovos_core/">Install as a Library</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../install_ovos_docker/">Install with Docker</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../install_gui/">Install GUI</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Starting OVOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../starting_intro/">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../starting_modules/">Starting Modules</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../starting_systemd/">Starting Systemd</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../starting_docker.md">Starting Docker</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Configuration</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../config/">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../config_ovos_config/">Using ovos-config</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../config_manual_config/">Manualy Editing Files</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">How To</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ht_intro/">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Skills</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../ht_skills/">Introduction</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../ht_skills_install/">Installing Skills</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../ht_skills_config/">Configuring</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">TTS</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../ht_tts/">Introduction</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../ht_tts_config/">Configuring</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../ht_change_voice/">Change Your Assistant's Voice</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Listener</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../ht_listener_intro/">Introduction</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../ht_mic/">Microphone</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../ht_stt/">STT</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../ht_ww/">WakeWord/HotWords</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../ht_vad/">VAD</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ht_phal/">PHAL</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Homescreen</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../ht_config_homescreen/">Configuration</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ht_config_security/">OpenVoiceOS Security</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Additional Services</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../selene_backend/">Selene Backend</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../personal_backend/">Personal Backend</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../kdeconnect/">KDE Connect</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Images</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../images_intro/">Introduction</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Buildroot</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#auto-detection-and-configuration-of-hats">Auto detection and configuration of HAT's</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#snapcast-client-server">Snapcast Client &amp; Server</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#remote-shared-folder-access-smb-windows">Remote shared folder access (SMB - Windows)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#remote-shared-folder-access-nfs-linux">Remote shared folder access (NFS - Linux)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#development">Development.</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#build-environment">Build Environment</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#installing-system-build-dependencies">Installing System Build Dependencies</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#the-following-firewall-ports-need-to-be-allowed-to-the-internet">The following firewall ports need to be allowed to the internet.</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#getting-the-code">Getting the code.</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#patching-buildroot">Patching Buildroot.</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#building-the-image">Building the image.</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#booting-image-from-sd-card-for-the-first-time-setting-up-wi-fi-and-backend">Booting image from sd card for the first time (setting up Wi-Fi and backend).</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#accessing-the-cli">Accessing the CLI.</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="" href="../install_raspbian.md">Raspbian</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Other Builds</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../mycroft/">Mycroft</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../neonos/">NeonOS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Troubleshooting</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../troubleshooting_intro/">Introduction to Troubleshooting</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../troubleshooting_audio/">Troubleshooting Audio</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../troubleshooting_installation/">Troubleshooting Installation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../troubleshooting_network/">Troubleshooting Network</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../troubleshooting_wakeword/">Troubleshooting Wakeword</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../troubleshooting_ovos_core/">Troubleshooting OVOS Core</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../troubleshooting_backend/">Troubleshooting Backend</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../troubleshooting_tts/">Troubleshooting TTS</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../troubleshooting_stt/">Troubleshooting STT</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../troubleshooting_skills/">Troubleshooting Skills</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../troubleshooting_plugins/">Troubleshooting Plugins</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Appendix</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../glossary/">Glossary</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../faq/">FAQ</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../compat.md">Compatibility</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../license/">License</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../friends/">Friends</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../members/">OVOS Members</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">OVOS User Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a> &raquo;</li>
          <li>Images &raquo;</li>
      <li class="breadcrumb-item active">Buildroot</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="open-voice-operating-system-buildroot-edition"><img src='https://camo.githubusercontent.com/48b782bbddb51b97cf2971fda5817080075f7799/68747470733a2f2f7261772e6769746861636b2e636f6d2f466f7274417765736f6d652f466f6e742d417765736f6d652f6d61737465722f737667732f736f6c69642f636f67732e737667' width='50' height='50' style='vertical-align:bottom'/> Open Voice Operating System - Buildroot Edition</h1>
<h2 id="auto-detection-and-configuration-of-hats">Auto detection and configuration of HAT's</h2>
<p>The buildroot OpenVoiceOS editions is considered to be consumer friendly type of device, or as Mycroft A.I. would like to call, a retail version. However as we so not target a specific hardware platform and would like to support custom made systems we are implementing a smart way to detect and configure different type of Raspberry Pi HAT's.</p>
<p>At boot the system scan the I2C bus for known and supported HAT's and if found configures the underlying linux sound system. At the moment this is still very much in development, however the below HAT's are or should soon be supported by this system;
- ReSpeaker 2-mic HAT
- ReSpeaker 4-mic Square HAT
- ReSpeaker 4-mic linear / 6-mic HAT
- USB devices such as the PS2 EYE
- SJ-201 Dev Kits
- SJ-201 Mark2 retail device</p>
<h2 id="snapcast-client-server">Snapcast Client &amp; Server</h2>
<p>TODO - write docs</p>
<h2 id="remote-shared-folder-access-smb-windows">Remote shared folder access (SMB - Windows)</h2>
<p>Your OpenVoiceOS device is accessible over the network from your Windows computer. This is still a work in process, but you can open a file explorer and navigate to you OpenVoiceOS device.
<img alt="" src="https://raw.githubusercontent.com/OpenVoiceOS/ovos_assets/master/Images/SMB%20shares.png" />
At the moment the following directories within the user's home directory are shared over the network.
- Documents
- Music
- Pictures
These folders are also used by KDE Connect file transfer plugins and for instance the Camera skill (Hey Mycroft, take a selfie) and / or Homescreen Skill (Hey Mycroft, take a screenshot)</p>
<h2 id="remote-shared-folder-access-nfs-linux">Remote shared folder access (NFS - Linux)</h2>
<p>In the near future the above Windows network shares are also made available over NFS for Linux clients. This is still a Work In Progress / To Do item.</p>
<h2 id="development">Development.</h2>
<p>At this moment development is in very early stages and focussed on the Raspberry Pi 3B &amp; 4. As soon as an initial first workable version
is created, other hardware might be added.</p>
<p>Source code: https://github.com/OpenVoiceOS/ovos-buildroot</p>
<h3 id="build-environment">Build Environment</h3>
<p>Only use x86_64 based architecture/ hardware to build the image. </p>
<p>The following example Build environment has been tested :</p>
<ul>
<li>Architecture: x86_64 </li>
<li>Hardware: Intel Core i5 processor, 8GB RAM, 240GB SSD (you can build on less RAM (2GB) and slower storage but more RAM, faster storage =  quicker image building)</li>
<li>OS: Ubuntu 22.04 LTS desktop</li>
</ul>
<h4 id="installing-system-build-dependencies">Installing System Build Dependencies</h4>
<p>The following system packages are required to build the image:</p>
<ul>
<li>gcc</li>
<li>subversion</li>
<li>qttools5-dev</li>
<li>qttools5-dev-tools</li>
<li>python</li>
<li>git</li>
<li>make</li>
<li>g++</li>
<li>curl</li>
<li>wget</li>
<li>qtdeclarative5-dev</li>
</ul>
<h4 id="the-following-firewall-ports-need-to-be-allowed-to-the-internet">The following firewall ports need to be allowed to the internet.</h4>
<p>In addition to the usual http/https ports (tcp 80, tcp 443) a couple of other ports need to be allowed to the internet :
- tcp 9418 (git).
- tcp 21 (ftp PASV) and random ports for DATA channel. This can be optional but better to have this allowed along with the corresponding random data channel ports. (knowledge of firewalls required)</p>
<h3 id="getting-the-code">Getting the code.</h3>
<p>First, get the code on your system! The simplest method is via git.
<br>
- cd ~/
- git clone --recurse-submodules https://github.com/OpenVoiceOS/OpenVoiceOS.git
- cd OpenVoiceOS</p>
<h3 id="patching-buildroot">Patching Buildroot.</h3>
<p><em>(ONLY at the first clean checkout/clone)</em> If this is the very first time you are going to build an image, you need to execute the following command once;
<br>
- ./scripts/br-patches.sh
<br>
This will patch the Buildroot packages.</p>
<h2 id="building-the-image">Building the image.</h2>
<p>Building the image(s) can be done by utilizing a proper Makefile;
<br>
To see the available commands, just run: 'make help'
<br>
As example to build the rpi4 version;<br>
- make clean
- make rpi4_64-gui-config
- make rpi4_64-gui</p>
<p>Now grab a cup of coffee, go for a walk, sleep and repeat as the build process takes up a long time pulling everything from source and cross compiling everything for the device. Especially the qtwebengine package is taking a LONG time.
<br>
(At the moment there is an outstanding issue which prevents the build to run completely to the end. The plasma-workspace package will error out, not finding the libGLESv4 properly linked within QT5GUI. When the build stopped because of this error, edit the following file;
<br><br>
buildroot/output/host/aarch64-buildroot-linux-gnu/sysroot/usr/lib/cmake/Qt5Gui/Qt5GuiConfigExtras.cmake
<br><br>
at the bottom of the file replace this line;
<br><br>
_qt5gui_find_extra_libs(OPENGL "GLESv2" "" "")
<br><br>And replace it bit this line;<br><br>
_qt5gui_find_extra_libs(OPENGL "${CMAKE_SYSROOT}/usr/lib/libGLESv2.so" "" "${CMAKE_SYSROOT}/usr/include/libdrm")
<br><br>
Then you can continue the build process by re-running the "make rpi4_64-gui" command. (DO NOT, run "make clean" and/or "make rpi4_64-gui-config" again, or you will start from scratch again !!!)
<br><br>
When everything goes fine the xz compressed image will be available within the release directory.</p>
<h3 id="booting-image-from-sd-card-for-the-first-time-setting-up-wi-fi-and-backend">Booting image from sd card for the first time (setting up Wi-Fi and backend).</h3>
<p>1.Ensure all required peripherals (mic, speakers, HDMI, usb mouse etc) are plugged in before powering on your RPI4 for the first time.
<br>
2. Skip this step if RPI4 is using an ethernet cable. Once powered on, the screen will present the Wifi setup screen ( a Wifi HotSpot is created). Connect to the Wifi HotSpot (ssid OVOS) from another device and follow the on-screen instructions to set up Wifi.
<br>
3.Once Wifi is setup a choice of Mycroft backend and Local backend is presented. Choose the Mycroft backend for now and follow the on-screen instructions, Local backend is not ready to use yet. After the pairing process has completed and skills downloaded it's time to test/ use it.</p>
<h3 id="accessing-the-cli">Accessing the CLI.</h3>
<ul>
<li>SSH to ip address of RPI4 </li>
<li>default credentials 'mycroft/mycroft'</li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../images_intro/" class="btn btn-neutral float-left" title="Introduction"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../mycroft/" class="btn btn-neutral float-right" title="Mycroft">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../images_intro/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../mycroft/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
